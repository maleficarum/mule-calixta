/**
 * This file was automatically generated by the Mule Cloud Connector Development Kit
 */
package mx.maleficarum.calixta;

import com.auronix.calixta.sms.SMSGateway;
import org.mule.tools.cloudconnect.annotations.Connector;
import org.mule.tools.cloudconnect.annotations.Operation;

import java.util.HashMap;
import java.util.Map;

/**
 * Sends SMS using Calixta (calixta.com.mx) service
 *
 * @author maleficarum (http://maleficarum.mx)
 */
@Connector(namespacePrefix="calixta")
public class CalixtaCloudConnector {

	private SMSGateway gateway;

	public CalixtaCloudConnector() {
		gateway = new SMSGateway();
	}

    @Operation
    public Object send(String destination, String text) {
		Map<String, Object> payload = new HashMap<String, Object>();
		payload.put("destination", destination);
		payload.put("text", text);

		try {
			payload.put("code" , Integer.valueOf(gateway.sendMessage(destination,text)));
		} catch(Exception e) {
			payload.put("code", -1);
			payload.put("error", e.getLocalizedMessage());
			e.printStackTrace();
		}
		return payload;
    }
}
